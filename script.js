// Dynamisk veiviser basert p√• flow.json

// === THEME TOGGLE ===
const initThemeToggle = () => {
  const themeToggle = document.getElementById('theme-toggle');
  const root = document.documentElement;
  
  // Hent lagret tema eller bruk system preferanse
  const savedTheme = localStorage.getItem('theme');
  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const initialTheme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
  
  // Sett initial tema
  root.setAttribute('data-theme', initialTheme);
  updateThemeButton(initialTheme);
  
  // Toggle tema ved klikk
  if (themeToggle) {
    themeToggle.addEventListener('click', () => {
      const currentTheme = root.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      
      root.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      updateThemeButton(newTheme);
    });
  }
  
  function updateThemeButton(theme) {
    const label = theme === 'dark' ? 'Bytt til lys modus' : 'Bytt til m√∏rk modus';
    if (themeToggle) {
      themeToggle.setAttribute('aria-label', label);
    }
  }
};

// === VIEW ROUTER ===
const initRouter = () => {
  const views = ['hjem', 'laer', 'sjekk', 'tiltak', 'ressurser', 'om'];
  const transition = document.getElementById('page-transition');
  
  const showView = (viewId) => {
    // Trigger transition overlay
    if (transition) {
      transition.classList.add('active');
    }
    
    // Wait for overlay to fade in (kortere tid for mindre flimring)
    setTimeout(() => {
      // Fjern active fra alle views
      document.querySelectorAll('.view').forEach(view => {
        view.classList.remove('active');
      });
      
      // Aktiver valgt view
      const targetView = document.getElementById(viewId);
      if (targetView) {
        targetView.classList.add('active');
        // Scroll til toppen
        window.scrollTo({ top: 0, behavior: 'auto' });
      }
      
      // Oppdater nav active state
      document.querySelectorAll('nav a').forEach(link => {
        link.removeAttribute('aria-current');
        if (link.getAttribute('href') === `#${viewId}`) {
          link.setAttribute('aria-current', 'page');
        }
      });
      
      // Fade out transition overlay
      setTimeout(() => {
        if (transition) {
          transition.classList.remove('active');
        }
      }, 30);
      
    }, 80); // Raskere timing for mindre flimring
  };
  
  const handleRoute = () => {
    let hash = window.location.hash.slice(1) || 'hjem';
    
    // Fallback til hjem hvis ukjent route
    if (!views.includes(hash)) {
      hash = 'hjem';
      window.location.hash = '#hjem';
    }
    
    showView(hash);
  };
  
  // Lytt til hash-endringer
  window.addEventListener('hashchange', handleRoute);
  
  // Initial route
  handleRoute();
  
  // Oppdater nav links for √• bruke hash routing
  document.querySelectorAll('nav a[href^="#"]').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const targetHash = link.getAttribute('href');
      window.location.hash = targetHash;
    });
  });
};

// === QUIZ LOGIC ===
document.addEventListener('DOMContentLoaded', () => {
  // Start theme toggle
  initThemeToggle();
  
  // Start router
  initRouter();
  
  // Start quiz hvis vi er p√• sjekk-siden
  const quiz = document.getElementById('quiz');
  if (!quiz) return;

  let flow = null;
  let history = []; // For tilbake-funksjonalitet

  const loadFlow = async () => {
    try {
      const res = await fetch('flow.json');
      if (!res.ok) {
        throw new Error(`HTTP error! status: ${res.status}`);
      }
      flow = await res.json();
      
      // Valider flow.json struktur
      const validationErrors = validateFlow(flow);
      if (validationErrors.length > 0) {
        console.error('Valideringsfeil i flow.json:', validationErrors);
        quiz.innerHTML = `
          <div class="card" style="border-left: 5px solid var(--stop)">
            <h3>‚ö†Ô∏è Konfigurasjonsfeil</h3>
            <p>Det er feil i sp√∏rsm√•lskonfigurasjonen som m√• rettes:</p>
            <ul style="margin: 16px 0; padding-left: 20px;">
              ${validationErrors.map(err => `<li style="margin: 8px 0;">${err}</li>`).join('')}
            </ul>
            <p class="note">Ta kontakt med administrator.</p>
          </div>
        `;
        return;
      }
      
      // Sjekk om det finnes lagret historikk
      const savedHistory = sessionStorage.getItem('ki_history');
      if (savedHistory) {
        try {
          const parsed = JSON.parse(savedHistory);
          if (parsed.length > 0) {
            // Tilby √• fortsette
            quiz.innerHTML = `
              <div class="card">
                <h3>üíæ Fortsette der du slapp?</h3>
                <p>Vi fant en lagret √∏kt med ${parsed.length} besvarte sp√∏rsm√•l.</p>
                <div style="display: flex; gap: 12px; margin-top: 16px; flex-wrap: wrap;">
                  <button class="cta" onclick="document.dispatchEvent(new CustomEvent('restoreHistory'))">
                    ‚Ü©Ô∏è Fortsett
                  </button>
                  <button class="cta-secondary" onclick="document.dispatchEvent(new CustomEvent('startFresh'))">
                    üîÑ Start p√• nytt
                  </button>
                </div>
              </div>
            `;
            
            // Event listeners for valg
            document.addEventListener('restoreHistory', () => {
              history = parsed;
              const lastStepId = history[history.length - 1];
              const lastStep = flow.steps.find(s => s.id === lastStepId);
              if (lastStep) {
                renderStep(lastStep);
              } else {
                startFresh();
              }
            }, { once: true });
            
            document.addEventListener('startFresh', startFresh, { once: true });
            return;
          }
        } catch (e) {
          console.warn('Kunne ikke parse lagret historikk:', e);
        }
      }
      
      // Start normalt
      startFresh();
      
    } catch (error) {
      console.error('Kunne ikke laste flow.json:', error);
      quiz.innerHTML = `
        <div class="card" style="border-left: 5px solid var(--stop)">
          <h3>‚ö†Ô∏è Kunne ikke laste veiviseren</h3>
          <p>Det oppstod en feil ved lasting av sp√∏rsm√•lsflyten.</p>
          <p class="note">Feil: ${error.message}</p>
          <button class="cta" onclick="location.reload()">Pr√∏v igjen</button>
        </div>
      `;
    }
  };
  
  const startFresh = () => {
    history = [];
    sessionStorage.removeItem('ki_history');
    renderStep(flow.steps[0]);
  };
  
  const validateFlow = (flow) => {
    const errors = [];
    
    if (!flow.steps || !Array.isArray(flow.steps)) {
      errors.push('Mangler "steps" array');
      return errors;
    }
    
    if (!flow.results || typeof flow.results !== 'object') {
      errors.push('Mangler "results" objekt');
      return errors;
    }
    
    const stepIds = new Set(flow.steps.map(s => s.id));
    const resultKeys = new Set(Object.keys(flow.results));
    
    flow.steps.forEach(step => {
      if (!step.id) {
        errors.push(`Steg mangler ID`);
        return;
      }
      
      if (!step.question) {
        errors.push(`Steg ${step.id}: Mangler sp√∏rsm√•l`);
      }
      
      if (!step.options || !Array.isArray(step.options)) {
        errors.push(`Steg ${step.id}: Mangler alternativer`);
        return;
      }
      
      step.options.forEach((opt, idx) => {
        if (!opt.text) {
          errors.push(`Steg ${step.id}, alternativ ${idx + 1}: Mangler tekst`);
        }
        
        if (opt.next && !stepIds.has(opt.next)) {
          errors.push(`Steg ${step.id}: Refererer til ikke-eksisterende steg ${opt.next}`);
        }
        
        if (opt.result && !resultKeys.has(opt.result)) {
          errors.push(`Steg ${step.id}: Refererer til ikke-eksisterende resultat "${opt.result}"`);
        }
        
        if (!opt.next && !opt.result) {
          errors.push(`Steg ${step.id}, alternativ ${idx + 1}: Mangler b√•de "next" og "result"`);
        }
      });
    });
    
    return errors;
  };

  const calculateProgress = () => {
    // Basert p√• faktisk antall sp√∏rsm√•l i historikk
    // Estimert maks antall sp√∏rsm√•l i en typisk sti er ca 12-15
    const estimatedMaxSteps = 15;
    const current = history.length;
    // Cap p√• 95% inntil vi n√•r resultat for √• unng√• 100% f√∏r ferdig
    const percent = Math.min(Math.round((current / estimatedMaxSteps) * 100), 95);
    return { current, percent };
  };

  const renderStep = (step) => {
    // Feilh√•ndtering: Sjekk om step eksisterer
    if (!step) {
      quiz.innerHTML = `
        <div class="card" style="border-left: 5px solid var(--stop); padding: 24px;">
          <h3>‚ö†Ô∏è Feil i veiviseren</h3>
          <p>Det oppstod en feil ‚Äì sp√∏rsm√•let ble ikke funnet. Dette kan skyldes en konfigurasjonsfeil.</p>
          <p class="note">Teknisk detalj: Manglende steg i flow.json</p>
          <button class="cta" onclick="location.reload()" style="margin-top: 16px;">üîÑ Start p√• nytt</button>
        </div>
      `;
      console.error('renderStep fikk undefined/null step. History:', history);
      return;
    }

    // Legg til i historikk
    history.push(step.id);
    
    // Lagre historikk i sessionStorage
    try {
      sessionStorage.setItem('ki_history', JSON.stringify(history));
    } catch (e) {
      console.warn('Kunne ikke lagre historikk:', e);
    }

    const progress = calculateProgress();
    
    quiz.innerHTML = `
      <div class="progress-container">
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${progress.percent}%"></div>
        </div>
        <p class="note" style="text-align: center; margin: 8px 0;">Sp√∏rsm√•l ${history.length}</p>
      </div>
      <h3>${step.question}</h3>
      ${step.help ? `<p class="help-text">üí° ${step.help}</p>` : ''}
      <div class="options-container"></div>
      <div class="nav-buttons"></div>
    `;

    const optionsContainer = quiz.querySelector('.options-container');
    step.options.forEach(o => {
      const b = document.createElement('button');
      b.className = 'cta';
      b.style.margin = '6px';
      b.textContent = o.text;
      b.onclick = () => {
        if (o.next) {
          const next = flow.steps.find(s => s.id === o.next);
          if (!next) {
            console.error(`Steg ${o.next} ikke funnet`);
            quiz.innerHTML = `
              <div class="card" style="border-left: 5px solid var(--stop)">
                <h3>‚ö†Ô∏è Navigasjonsfeil</h3>
                <p>Kunne ikke finne neste sp√∏rsm√•l (ID: ${o.next}).</p>
                <button class="cta" onclick="location.reload()">Start p√• nytt</button>
              </div>
            `;
            return;
          }
          renderStep(next);
        } else if (o.result) {
          showResult(o.result);
        }
      };
      optionsContainer.appendChild(b);
    });

    // Tilbake-knapp
    const navButtons = quiz.querySelector('.nav-buttons');
    if (history.length > 1) {
      const backBtn = document.createElement('button');
      backBtn.className = 'cta-secondary';
      backBtn.textContent = '‚Üê Tilbake';
      backBtn.style.marginTop = '16px';
      backBtn.onclick = () => goBack();
      navButtons.appendChild(backBtn);
    }
  };

  const goBack = () => {
    if (history.length > 1) {
      history.pop(); // Fjern n√•v√¶rende
      const previousStepId = history.pop(); // Fjern og hent forrige
      const previousStep = flow.steps.find(s => s.id === previousStepId);
      if (previousStep) {
        renderStep(previousStep);
      }
    }
  };

  const showResult = (key) => {
    const r = flow.results[key];
    
    if (!r) {
      quiz.innerHTML = `
        <div class="card" style="border-left: 5px solid var(--stop)">
          <h3>‚ö†Ô∏è Resultat ikke funnet</h3>
          <p>Resultatn√∏kkel "${key}" eksisterer ikke i konfigurasjonen.</p>
          <button class="cta" onclick="location.reload()">Start p√• nytt</button>
        </div>
      `;
      console.error(`Resultat "${key}" ikke funnet i flow.results`);
      return;
    }
    
    // Rens sessionStorage n√•r resultat vises
    sessionStorage.removeItem('ki_history');
    
    // Bygg resultat-HTML
    let resultHTML = `
      <div class="result-card ${r.class}">
        <h3>${r.title}</h3>
        <div class="result-text">${r.text.replace(/\n/g, '<br>')}</div>
    `;

    // Legg til handlinger hvis de finnes
    if (r.actions && r.actions.length > 0) {
      resultHTML += `
        <div class="actions-list">
          <h4>üìã Neste steg:</h4>
          <ul>
            ${r.actions.map(action => `<li>${action}</li>`).join('')}
          </ul>
        </div>
      `;
    }

    // Legg til artikkelreferanser hvis de finnes
    if (r.articles && r.articles.length > 0) {
      console.log('Viser artikler:', r.articles); // DEBUG
      resultHTML += `
        <div class="articles-list">
          <h4>‚öñÔ∏è Juridisk grunnlag (AI Act):</h4>
          <div class="articles-grid">
            ${r.articles.map(article => `
              <div class="article-card">
                <div class="article-number">${article.number}</div>
                <div class="article-content">
                  <strong>${article.title}</strong>
                  <p>${article.description}</p>
                  <a href="${article.url}" target="_blank" rel="noopener" class="article-link">
                    Les mer ‚Üí
                  </a>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    } else {
      console.log('Ingen artikler funnet for:', r.title); // DEBUG
    }

    // Legg til GDPR referanser hvis de finnes
    if (r.gdpr && r.gdpr.length > 0) {
      resultHTML += `
        <div class="gdpr-list">
          <h4>üîí GDPR/Personvern:</h4>
          <ul class="compact-list">
            ${r.gdpr.map(gdpr => `<li>${gdpr}</li>`).join('')}
          </ul>
        </div>
      `;
    }

    // Legg til andre lover hvis de finnes
    if (r.other_laws && r.other_laws.length > 0) {
      resultHTML += `
        <div class="other-laws-list">
          <h4>üìö Annet lovverk:</h4>
          <ul class="compact-list">
            ${r.other_laws.map(law => `<li>${law}</li>`).join('')}
          </ul>
        </div>
      `;
    }

    resultHTML += `</div>`;
    quiz.innerHTML = resultHTML;

    // Knapper
    const btnContainer = document.createElement('div');
    btnContainer.style.marginTop = '16px';
    btnContainer.style.display = 'flex';
    btnContainer.style.gap = '10px';
    btnContainer.style.flexWrap = 'wrap';

    const dl = document.createElement('button');
    dl.className = 'cta';
    dl.textContent = 'üì• Last ned vurdering';
    dl.onclick = () => downloadResult(r);
    btnContainer.appendChild(dl);

    const reset = document.createElement('button');
    reset.className = 'cta-secondary';
    reset.textContent = 'üîÑ Start p√• nytt';
    reset.onclick = () => loadFlow();
    btnContainer.appendChild(reset);

    quiz.appendChild(btnContainer);
  };

  const downloadResult = (result) => {
    const timestamp = new Date().toISOString().split('T')[0];
    const time = new Date().toLocaleTimeString('nb-NO');
    
    let content = `
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë     KI-FORORDNINGEN I SKOLEN - RISIKOVURDERING            ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

Dato: ${timestamp} ${time}

${result.title}
${'='.repeat(result.title.length)}

${result.text}
`;

    if (result.actions && result.actions.length > 0) {
      content += `

ANBEFALTE HANDLINGER:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
`;
      result.actions.forEach((action, i) => {
        content += `${i + 1}. ${action}\n`;
      });
    }

    // Legg til AI Act artikler
    if (result.articles && result.articles.length > 0) {
      content += `

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

JURIDISK GRUNNLAG - EU AI ACT:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
`;
      result.articles.forEach((article, i) => {
        content += `
${article.number}: ${article.title}
${article.description}
URL: ${article.url}
`;
      });
    }

    // Legg til GDPR referanser
    if (result.gdpr && result.gdpr.length > 0) {
      content += `

GDPR/PERSONVERNLOVGIVNING:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
`;
      result.gdpr.forEach((gdpr, i) => {
        content += `‚Ä¢ ${gdpr}\n`;
      });
    }

    // Legg til annet lovverk
    if (result.other_laws && result.other_laws.length > 0) {
      content += `

ANNET RELEVANT LOVVERK:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
`;
      result.other_laws.forEach((law, i) => {
        content += `‚Ä¢ ${law}\n`;
      });
    }

    content += `

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

RESSURSER:
- EU AI Act (offisiell tekst): https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689
- AI Act oversikt: https://artificialintelligenceact.eu/
- Datatilsynet (GDPR): https://www.datatilsynet.no/
- Datatilsynet (KI): https://www.datatilsynet.no/regelverk-og-verktoy/kunstig-intelligens-og-personvern/
- GDPR guide: https://gdpr.eu/
- Personopplysningsloven: https://lovdata.no/dokument/NL/lov/2018-06-15-38
- Oppl√¶ringsloven: https://lovdata.no/dokument/NL/lov/1998-07-17-61
- Utdanningsdirektoratet (KI): https://www.udir.no/laring-og-trivsel/rammeverk/kompetansepakke-for-kunstig-intelligens-i-skolen/

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Denne vurderingen er generert av: KI-forordningen i skolen
Versjon: 0.4 | Lisens: CC BY-SA  
Repository: github.com/barx10/ki_forordninga

VIKTIG: Dette er en veiledende vurdering. Konsulter alltid
med personvernombud, DPO og skolens ledelse f√∏r implementering
av KI-systemer.
`;

    const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `ki-risikovurdering-${timestamp}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  };

  loadFlow();
});

// === ACCORDION FUNCTIONALITY ===
document.addEventListener('DOMContentLoaded', () => {
  const accordionHeaders = document.querySelectorAll('.accordion-header');
  
  accordionHeaders.forEach(header => {
    header.addEventListener('click', () => {
      const expanded = header.getAttribute('aria-expanded') === 'true';
      
      // Close all other accordions (optional - remove if you want multiple open)
      accordionHeaders.forEach(otherHeader => {
        if (otherHeader !== header) {
          otherHeader.setAttribute('aria-expanded', 'false');
        }
      });
      
      // Toggle current accordion
      header.setAttribute('aria-expanded', !expanded);
    });
  });
  
  // Update timeline based on current date
  updateTimeline();
});

// === UPDATE TIMELINE ===
function updateTimeline() {
  const timeline = document.getElementById('ai-timeline');
  if (!timeline) return;
  
  const today = new Date();
  today.setHours(0, 0, 0, 0); // Reset time to midnight for accurate date comparison
  
  const timelineItems = timeline.querySelectorAll('.timeline-item[data-date]');
  
  timelineItems.forEach(item => {
    const dateStr = item.getAttribute('data-date');
    const milestoneDate = new Date(dateStr);
    
    // If milestone date has passed, mark as complete
    if (milestoneDate <= today) {
      item.classList.add('complete');
    } else {
      item.classList.remove('complete');
    }
  });
}

// === DOWNLOAD TILTAKSPLAN ===
function printTiltaksplan() {
  // Create a print-friendly version
  const printWindow = window.open('', '_blank');
  const timestamp = new Date().toLocaleDateString('nb-NO', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
  
  const content = `
<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <title>KI-forordningen: Tiltaksplan</title>
  <style>
    @page {
      size: A4;
      margin: 2cm;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #1a1a1a;
      background: white;
      font-size: 11pt;
    }
    
    .cover {
      text-align: center;
      padding: 4cm 2cm;
      page-break-after: always;
      border: 3px solid #2563eb;
      margin: 1cm 0;
    }
    
    .cover h1 {
      font-size: 32pt;
      color: #2563eb;
      margin-bottom: 1cm;
      font-weight: 700;
    }
    
    .cover h2 {
      font-size: 18pt;
      color: #64748b;
      margin-bottom: 2cm;
      font-weight: 400;
    }
    
    .cover .meta {
      font-size: 12pt;
      color: #64748b;
      margin-top: 2cm;
    }
    
    h2 {
      color: #2563eb;
      font-size: 16pt;
      margin-top: 1.5cm;
      margin-bottom: 0.5cm;
      padding-bottom: 0.3cm;
      border-bottom: 2px solid #2563eb;
      page-break-after: avoid;
    }
    
    h3 {
      color: #1e40af;
      font-size: 13pt;
      margin-top: 1cm;
      margin-bottom: 0.3cm;
      page-break-after: avoid;
    }
    
    p {
      margin-bottom: 0.5cm;
      text-align: justify;
    }
    
    .intro {
      background: #eff6ff;
      padding: 0.8cm;
      border-left: 4px solid #2563eb;
      margin: 1cm 0;
      page-break-inside: avoid;
    }
    
    .phase {
      margin-bottom: 1.5cm;
      page-break-inside: avoid;
    }
    
    .phase-header {
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
      color: white;
      padding: 0.5cm;
      margin-bottom: 0.5cm;
      border-radius: 4px;
    }
    
    .card {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-left: 4px solid #2563eb;
      padding: 0.6cm;
      margin-bottom: 0.8cm;
      page-break-inside: avoid;
    }
    
    .card h4 {
      color: #1e40af;
      font-size: 12pt;
      margin-bottom: 0.3cm;
    }
    
    ul {
      margin-left: 1cm;
      margin-bottom: 0.5cm;
    }
    
    li {
      margin-bottom: 0.2cm;
      list-style-type: none;
      position: relative;
      padding-left: 0.5cm;
    }
    
    li:before {
      content: "‚ñ∏";
      color: #2563eb;
      font-weight: bold;
      position: absolute;
      left: 0;
    }
    
    .checklist li:before {
      content: "‚òê";
      color: #2563eb;
    }
    
    .responsibility {
      background: #fef3c7;
      border-left: 3px solid #f59e0b;
      padding: 0.3cm;
      margin-top: 0.3cm;
      font-size: 10pt;
      page-break-inside: avoid;
    }
    
    .alert {
      background: #fee2e2;
      border-left: 4px solid #ef4444;
      padding: 0.5cm;
      margin: 0.5cm 0;
      page-break-inside: avoid;
    }
    
    .resources {
      background: #f0fdf4;
      border: 1px solid #86efac;
      padding: 0.5cm;
      margin: 0.5cm 0;
      font-size: 10pt;
      page-break-inside: avoid;
    }
    
    .resources h4 {
      color: #16a34a;
      margin-bottom: 0.3cm;
    }
    
    .timeline {
      margin: 1cm 0;
    }
    
    .timeline-item {
      display: flex;
      align-items: flex-start;
      margin-bottom: 0.5cm;
      page-break-inside: avoid;
    }
    
    .timeline-dot {
      width: 0.4cm;
      height: 0.4cm;
      border-radius: 50%;
      margin-right: 0.5cm;
      margin-top: 0.2cm;
      flex-shrink: 0;
    }
    
    .timeline-dot.complete {
      background: #22c55e;
    }
    
    .timeline-dot.pending {
      background: #3b82f6;
    }
    
    .footer {
      margin-top: 2cm;
      padding-top: 0.5cm;
      border-top: 1px solid #e2e8f0;
      font-size: 9pt;
      color: #64748b;
      text-align: center;
    }
    
    @media print {
      body {
        print-color-adjust: exact;
        -webkit-print-color-adjust: exact;
      }
    }
  </style>
</head>
<body>
  <div class="cover">
    <h1>KI-FORORDNINGEN<br/>I SKOLEN</h1>
    <h2>Komplett tiltaksplan for AI Act compliance</h2>
    <div class="meta">
      <p><strong>Generert:</strong> ${timestamp}</p>
      <p><strong>Versjon:</strong> 0.4</p>
    </div>
  </div>
  
  <div class="intro">
    <h2>Innledning</h2>
    <p>
      Denne tiltaksplanen gir deg en steg-for-steg guide til √• bli compliant med 
      EU's AI Act (KI-forordningen) i skolen.
    </p>
    <p>
      AI Act tr√•dte i kraft 1. august 2024, med gradvis innf√∏ring:
    </p>
    <div class="timeline">
      <div class="timeline-item">
        <div class="timeline-dot complete"></div>
        <div><strong>August 2024:</strong> Forordningen tr√•dte i kraft</div>
      </div>
      <div class="timeline-item">
        <div class="timeline-dot complete"></div>
        <div><strong>Februar 2025:</strong> Forbud mot uakseptable praksiser</div>
      </div>
      <div class="timeline-item">
        <div class="timeline-dot complete"></div>
        <div><strong>August 2025:</strong> Krav til generativ KI (ER N√Ö AKTIV!)</div>
      </div>
      <div class="timeline-item">
        <div class="timeline-dot pending"></div>
        <div><strong>August 2026:</strong> Transparenskrav</div>
      </div>
      <div class="timeline-item">
        <div class="timeline-dot pending"></div>
        <div><strong>August 2027:</strong> Alle h√∏yrisiko-krav</div>
      </div>
    </div>
    <p>Start med Fase 1 og arbeid deg systematisk gjennom alle fasene.</p>
  </div>
  
  <h2>Fase 1: Kartlegging (Uke 1-2)</h2>
  
  <div class="card">
    <h4>1.1 Kartlegg alle KI-verkt√∏y</h4>
    <p>Lag en fullstendig liste over alle KI-systemer som brukes p√• skolen.</p>
    <ul class="checklist">
      <li>Chatboter (ChatGPT, Bing Chat, Claude, etc.)</li>
      <li>Generative AI-verkt√∏y (Midjourney, DALL-E, etc.)</li>
      <li>Adaptive l√¶ringssystemer (Khan Academy, etc.)</li>
      <li>Oversettelsesverkt√∏y (Google Translate, DeepL)</li>
      <li>Vurderingssystemer med KI</li>
      <li>Spamfiltre og sikkerhetssystemer</li>
      <li>L√¶ringsspill med KI</li>
    </ul>
    <div class="responsibility">
      <strong>Ansvar:</strong> IKT-ansvarlig + skoleleder
    </div>
  </div>
  
  <div class="card">
    <h4>1.2 Klassifiser risikoniv√•</h4>
    <p>For hvert verkt√∏y: Bestem risikoniv√•.</p>
    <ul>
      <li><strong>MINIMAL:</strong> Spamfilter, enkle l√¶ringsspill</li>
      <li><strong>TRANSPARENS:</strong> Chatboter, generativ AI</li>
      <li><strong>H√òY RISIKO:</strong> Vurdering, karaktersystemer, elevprofiler</li>
      <li><strong>UAKSEPTABEL:</strong> Manipulasjon, skjult scoring, diskriminering</li>
    </ul>
    <div class="responsibility">
      <strong>Verkt√∏y:</strong> Bruk veiviseren p√• ki-forordningen.no
    </div>
  </div>
  
  <div class="card">
    <h4>1.3 Lag oversikt med dokumentasjon</h4>
    <p>Dokumenter alle verkt√∏y i en tabell eller database.</p>
    <ul class="checklist">
      <li>Verkt√∏ynavn og leverand√∏r</li>
      <li>Form√•l og bruksomr√•de</li>
      <li>Risikoniv√• (Minimal/Transparens/H√∏y/Uakseptabel)</li>
      <li>Ansvarlig l√¶rer/koordinator</li>
      <li>Dato for siste vurdering</li>
      <li>Status (Godkjent/Under vurdering/Ikke tillatt)</li>
      <li>Link til databehandleravtale (hvis relevant)</li>
    </ul>
    <div class="responsibility">
      <strong>Mal:</strong> Excel eller Google Sheets
    </div>
  </div>
  
  <h2>Fase 2: Personvern og GDPR (Uke 3-4)</h2>
  
  <div class="card">
    <h4>2.1 Databehandleravtaler</h4>
    <p>Alle verkt√∏y som behandler persondata M√Ö ha signert databehandleravtale (DBA).</p>
    <ul class="checklist">
      <li>Form√•l og varighet av behandlingen</li>
      <li>Type persondata som behandles</li>
      <li>Sikkerhetstiltak (kryptering, tilgangskontroll)</li>
      <li>Hvor data lagres (EU/E√òS vs. tredjeland)</li>
      <li>Underleverand√∏rer (hvem har tilgang?)</li>
      <li>Prosedyre for sletting ved oppsigelse</li>
      <li>Rett til revisjon og kontroll</li>
    </ul>
    <div class="responsibility">
      <strong>Ansvar:</strong> Personvernombud/DPO + IKT-ansvarlig
    </div>
  </div>
  
  <div class="card">
    <h4>2.2 DPIA for h√∏yrisiko-systemer</h4>
    <p>Personvernkonsekvensvurdering (DPIA) er LOVP√ÖLAGT for h√∏yrisiko KI.</p>
    <ul class="checklist">
      <li>Systematisk beskrivelse av databehandlingen</li>
      <li>Form√•l og n√∏dvendighet (hvorfor KI?)</li>
      <li>Risikovurdering (hva kan g√• galt?)</li>
      <li>Tiltak for √• redusere risiko</li>
      <li>Proporsjonalitetsvurdering (nytte vs. risiko)</li>
      <li>Godkjenning av personvernombud/DPO</li>
      <li>√Örlig oppdatering</li>
    </ul>
    <div class="resources">
      <h4>Verkt√∏y:</h4>
      <p>https://www.datatilsynet.no/rettigheter-og-plikter/virksomhetenes-plikter/vurdere-personvernkonsekvenser/</p>
    </div>
  </div>
  
  <div class="card">
    <h4>2.3 Informer elever og foresatte</h4>
    <p>Transparens er et krav b√•de i GDPR og AI Act.</p>
    <ul class="checklist">
      <li>Hvilke KI-verkt√∏y som brukes</li>
      <li>Form√•l (hvorfor brukes KI?)</li>
      <li>Hvilke data som samles inn</li>
      <li>Hvordan data beskyttes</li>
      <li>Hvem som har tilgang til data</li>
      <li>Hvor lenge data lagres</li>
      <li>Rett til innsyn, sletting og reservasjon</li>
      <li>Kontaktinformasjon for sp√∏rsm√•l</li>
    </ul>
    <div class="responsibility">
      <strong>Kanal:</strong> Foreldrem√∏te, nyhetsbrev, Vigilo/Its learning
    </div>
  </div>
  
  <h2>Fase 3: Ansvar og organisering (Uke 5-6)</h2>
  
  <div class="card">
    <h4>3.1 Opprett KI-arbeidsgruppe</h4>
    <p>Samle n√∏kkelpersoner som skal jobbe med KI-implementering.</p>
    <ul class="checklist">
      <li>Skoleleder (ansvarlig for compliance)</li>
      <li>IKT-ansvarlig (teknisk kompetanse)</li>
      <li>Personvernombud/DPO (GDPR-ansvar)</li>
      <li>L√¶rerrepresentant (brukerperspektiv)</li>
      <li>Elevrepresentant (brukermedvirkning)</li>
      <li>Tillitsvalgt (medbestemmelse)</li>
    </ul>
    <div class="responsibility">
      <strong>M√∏tefrekvens:</strong> M√•nedlig f√∏rste √•r, deretter kvartalsvis
    </div>
  </div>
  
  <div class="card">
    <h4>3.2 Utarbeid retningslinjer</h4>
    <p>Skriv ned klare retningslinjer for bruk av KI p√• skolen.</p>
    <ul class="checklist">
      <li>Tillatte KI-verkt√∏y og bruksomr√•der</li>
      <li>Forbudte verkt√∏y og praksiser</li>
      <li>L√¶rernes ansvar og plikter</li>
      <li>Elevenes rettigheter (klageadgang, innsyn)</li>
      <li>Pedagogisk begrunnelse for KI-bruk</li>
      <li>Personvern og datasikkerhet</li>
      <li>Vurdering og evaluering med KI</li>
      <li>H√•ndtering av hendelser og klager</li>
      <li>Prosess for evaluering og oppdatering</li>
    </ul>
    <div class="responsibility">
      <strong>Godkjenning:</strong> Skolens ledelse + medvirkning fra ansatte og elever
    </div>
  </div>
  
  <div class="card">
    <h4>3.3 Definer ansvarsroller</h4>
    <p>Klargj√∏r hvem som er ansvarlig for hva.</p>
    <ul>
      <li><strong>SKOLELEDER:</strong> Overordnet ansvar for AI Act compliance</li>
      <li><strong>IKT-ANSVARLIG:</strong> Teknisk drift, avtaler med leverand√∏rer</li>
      <li><strong>PERSONVERNOMBUD:</strong> GDPR-compliance, DPIA-godkjenning</li>
      <li><strong>KI-KOORDINATOR:</strong> Daglig oppf√∏lging av KI-verkt√∏y</li>
      <li><strong>L√ÜRERE:</strong> Ansvarlig bruk, dokumentasjon, tilbakemelding</li>
      <li><strong>LEVERAND√òR:</strong> Teknisk dokumentasjon, oppdateringer, support</li>
    </ul>
    <div class="responsibility">
      <strong>Dokument:</strong> Lag en RACI-matrise (Responsible, Accountable, Consulted, Informed)
    </div>
  </div>
  
  <h2>Fase 4: Kompetansebygging (P√•g√•ende)</h2>
  
  <div class="card">
    <h4>4.1 Oppl√¶ring for l√¶rere</h4>
    <p>Alle l√¶rere m√• ha grunnleggende KI- og AI Act-kompetanse.</p>
    <ul class="checklist">
      <li>Hva er KI? (Grunnleggende forst√•else)</li>
      <li>AI Act og GDPR (Juridisk ramme)</li>
      <li>Risikovurdering (Hvordan klassifisere?)</li>
      <li>Personvern og datasikkerhet</li>
      <li>Elevrettigheter og medvirkning</li>
      <li>Ansvarlig bruk av KI i vurdering</li>
      <li>Pedagogisk bruk (n√•r er KI hensiktsmessig?)</li>
      <li>H√•ndtering av hendelser</li>
    </ul>
    <div class="resources">
      <h4>Ressurs:</h4>
      <p>https://www.udir.no/laring-og-trivsel/rammeverk/kompetansepakke-for-kunstig-intelligens-i-skolen/</p>
    </div>
  </div>
  
  <div class="card">
    <h4>4.2 KI-undervisning for elever</h4>
    <p>Elever skal forst√• KI og sine rettigheter.</p>
    <ul class="checklist">
      <li>Hva er KI og hvordan fungerer det?</li>
      <li>Kildekritikk (KI gj√∏r feil!)</li>
      <li>Etikk og ansvar</li>
      <li>Personvern og datarettigheter</li>
      <li>Rett til innsyn, sletting og klage</li>
      <li>Opphavsrett og KI-generert innhold</li>
      <li>Kreativ og kritisk bruk</li>
    </ul>
    <div class="responsibility">
      <strong>Integrasjon:</strong> Tverrfaglig i alle fag
    </div>
  </div>
  
  <div class="card">
    <h4>4.3 L√∏pende kompetanseheving</h4>
    <p>KI-feltet utvikler seg raskt. Kontinuerlig l√¶ring er n√∏dvendig.</p>
    <ul class="checklist">
      <li>M√•nedlige frokostm√∏ter om KI</li>
      <li>Fagfellesskap (f.eks. l√¶rerLiv.no)</li>
      <li>Nyhetsbrev fra Datatilsynet og Udir</li>
      <li>Kurs og webinarer</li>
      <li>Pilotering og testing av nye verkt√∏y</li>
      <li>Deling av erfaringer p√• personalm√∏ter</li>
    </ul>
    <div class="responsibility">
      <strong>Tid:</strong> Sett av 2 timer/m√•ned i √•rshjulet
    </div>
  </div>
  
  <h2>Fase 5: Oppf√∏lging og evaluering (Kontinuerlig)</h2>
  
  <div class="card">
    <h4>5.1 Logging og monitorering</h4>
    <p>Dokumenter bruk av KI-systemer, spesielt h√∏yrisiko.</p>
    <ul class="checklist">
      <li>Bruksstatistikk (hvor mye brukes systemet?)</li>
      <li>L√¶rerinngrep (overstyringer av KI-beslutninger)</li>
      <li>Hendelser og feil</li>
      <li>Klager fra elever/foresatte</li>
      <li>Systemoppdateringer og endringer</li>
      <li>DPIA-oppdateringer</li>
    </ul>
    <div class="responsibility">
      <strong>Lagringstid:</strong> Minimum 6 m√•neder (AI Act Art. 29)
    </div>
  </div>
  
  <div class="card">
    <h4>5.2 Bias-testing og kvalitetskontroll</h4>
    <p>Test KI-systemer jevnlig for bias og diskriminering.</p>
    <ul class="checklist">
      <li>Kj√∏nnsbias (gutter vs. jenter?)</li>
      <li>Spr√•kbias (norsk vs. andre spr√•k?)</li>
      <li>Alderbias (yngre vs. eldre elever?)</li>
      <li>Kulturell bias (minoriteter?)</li>
      <li>Funksjonshemming (universell utforming?)</li>
      <li>Teknisk n√∏yaktighet (feilrater?)</li>
    </ul>
    <div class="responsibility">
      <strong>Frekvens:</strong> Halv√•rlig for h√∏yrisiko-systemer
    </div>
  </div>
  
  <div class="card">
    <h4>5.3 √Örlig gjennomgang</h4>
    <p>Sett av tid i √•rshjulet til √• evaluere og oppdatere.</p>
    <ul class="checklist">
      <li>Oppdater oversikt over KI-verkt√∏y</li>
      <li>Re-evaluer risikoniv√•</li>
      <li>Sjekk at alle avtaler er gyldige</li>
      <li>DPIA-oppdatering for h√∏yrisiko</li>
      <li>Evaluer retningslinjer (trenger de endring?)</li>
      <li>H√∏r med brukere (l√¶rere, elever, foresatte)</li>
      <li>Analyser logger og hendelser</li>
      <li>Dokumenter compliance med AI Act</li>
      <li>Sett m√•l for neste √•r</li>
    </ul>
    <div class="responsibility">
      <strong>Tidspunkt:</strong> Mai/juni (planlegg for nytt skole√•r)
    </div>
  </div>
  
  <h2>Kriseh√•ndtering</h2>
  
  <div class="alert">
    <h3>Hvis noe g√•r galt:</h3>
    <ol style="margin-left: 1cm;">
      <li><strong>STOPP</strong> bruken av systemet umiddelbart</li>
      <li><strong>DOKUMENTER</strong> hendelsen (hva, n√•r, hvem)</li>
      <li><strong>INFORMER</strong> ber√∏rte parter (elever, foresatte, personvernombud)</li>
      <li><strong>KONTAKT</strong> leverand√∏r og personvernombud</li>
      <li><strong>VURDER</strong> rapporteringsplikt (Datatilsynet innen 72 timer ved GDPR-brudd)</li>
      <li><strong>JUSTER</strong> rutiner for √• forhindre gjentakelse</li>
    </ol>
  </div>
  
  <h2>Viktige ressurser</h2>
  
  <div class="resources">
    <h4>EU AI Act:</h4>
    <p>https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689</p>
  </div>
  
  <div class="resources">
    <h4>Datatilsynet (GDPR):</h4>
    <p>https://www.datatilsynet.no/</p>
  </div>
  
  <div class="resources">
    <h4>Datatilsynet (KI-veiledning):</h4>
    <p>https://www.datatilsynet.no/regelverk-og-verktoy/kunstig-intelligens-og-personvern/</p>
  </div>
  
  <div class="resources">
    <h4>Utdanningsdirektoratet (KI-kompetansepakke):</h4>
    <p>https://www.udir.no/laring-og-trivsel/rammeverk/kompetansepakke-for-kunstig-intelligens-i-skolen/</p>
  </div>
  
  <div class="resources">
    <h4>Lovdata - Oppl√¶ringsloven:</h4>
    <p>https://lovdata.no/dokument/NL/lov/1998-07-17-61</p>
  </div>
  
  <div class="resources">
    <h4>l√¶rerLiv (fagfellesskap):</h4>
    <p>https://www.laererliv.no/</p>
  </div>
  
  <div class="footer">
    <p>
      <strong>Generert av:</strong> KI-forordningen i skolen | 
      <strong>Versjon:</strong> 0.4 | 
      <strong>Lisens:</strong> CC BY-SA
    </p>
    <p>
      <strong>Repository:</strong> github.com/barx10/ki_forordninga
    </p>
    <p style="margin-top: 0.5cm;">
      <em>VIKTIG: Dette er en veiledende tiltaksplan. Konsulter alltid med personvernombud, 
      DPO og skolens ledelse f√∏r implementering av KI-systemer.</em>
    </p>
  </div>
</body>
</html>
  `;
  
  printWindow.document.write(content);
  printWindow.document.close();
  
  // Wait for content to load, then trigger print dialog
  printWindow.onload = function() {
    printWindow.focus();
    printWindow.print();
  };
}

function downloadTiltaksplan() {
  const timestamp = new Date().toISOString().slice(0, 10);
  
  const content = `
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                           ‚ïë
‚ïë   KI-FORORDNINGEN I SKOLEN                               ‚ïë
‚ïë   Komplett tiltaksplan for AI Act compliance             ‚ïë
‚ïë                                                           ‚ïë
‚ïë   Generert: ${timestamp}                                 ‚ïë
‚ïë   Versjon: 0.4                                           ‚ïë
‚ïë                                                           ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù


INNLEDNING
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Denne tiltaksplanen gir deg en steg-for-steg guide til √• bli
compliant med EU's AI Act (KI-forordningen) i skolen.

AI Act tr√•dte i kraft 1. august 2024, med gradvis innf√∏ring:
- Februar 2025: Forbud mot uakseptable praksiser
- August 2025: Krav til generativ KI (ER N√Ö AKTIV!)
- August 2026: Transparenskrav
- August 2027: Alle h√∏yrisiko-krav

Start med Fase 1 og arbeid deg systematisk gjennom alle fasene.


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FASE 1: KARTLEGGING (UKE 1-2)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

1.1 KARTLEGG ALLE KI-VERKT√òY
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Lag en fullstendig liste over alle KI-systemer som brukes 
p√• skolen.

Sjekkliste:
  ‚òê Chatboter (ChatGPT, Bing Chat, Claude, etc.)
  ‚òê Generative AI-verkt√∏y (Midjourney, DALL-E, etc.)
  ‚òê Adaptive l√¶ringssystemer (Khan Academy, etc.)
  ‚òê Oversettelsesverkt√∏y (Google Translate, DeepL)
  ‚òê Vurderingssystemer med KI
  ‚òê Spamfiltre og sikkerhetssystemer
  ‚òê L√¶ringsspill med KI

Ansvar: IKT-ansvarlig + skoleleder


1.2 KLASSIFISER RISIKONIV√Ö
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

For hvert verkt√∏y: Bestem risikoniv√•.

Klassifiseringskriterier:
  ‚Ä¢ MINIMAL: Spamfilter, enkle l√¶ringsspill
  ‚Ä¢ TRANSPARENS: Chatboter, generativ AI
  ‚Ä¢ H√òY RISIKO: Vurdering, karaktersystemer, elevprofiler
  ‚Ä¢ UAKSEPTABEL: Manipulasjon, skjult scoring, diskriminering

Verkt√∏y: Bruk veiviseren p√• ki-forordningen.no


1.3 LAG OVERSIKT MED DOKUMENTASJON
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Dokumenter alle verkt√∏y i en tabell eller database.

Kolonner i oversikten:
  ‚Ä¢ Verkt√∏ynavn og leverand√∏r
  ‚Ä¢ Form√•l og bruksomr√•de
  ‚Ä¢ Risikoniv√• (Minimal/Transparens/H√∏y/Uakseptabel)
  ‚Ä¢ Ansvarlig l√¶rer/koordinator
  ‚Ä¢ Dato for siste vurdering
  ‚Ä¢ Status (Godkjent/Under vurdering/Ikke tillatt)
  ‚Ä¢ Link til databehandleravtale (hvis relevant)

Mal: Excel eller Google Sheets


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FASE 2: PERSONVERN OG GDPR (UKE 3-4)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

2.1 DATABEHANDLERAVTALER
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Alle verkt√∏y som behandler persondata M√Ö ha signert 
databehandleravtale (DBA).

Hva m√• avtalen inneholde:
  ‚òê Form√•l og varighet av behandlingen
  ‚òê Type persondata som behandles
  ‚òê Sikkerhetstiltak (kryptering, tilgangskontroll)
  ‚òê Hvor data lagres (EU/E√òS vs. tredjeland)
  ‚òê Underleverand√∏rer (hvem har tilgang?)
  ‚òê Prosedyre for sletting ved oppsigelse
  ‚òê Rett til revisjon og kontroll

Ansvar: Personvernombud/DPO + IKT-ansvarlig


2.2 DPIA FOR H√òYRISIKO-SYSTEMER
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Personvernkonsekvensvurdering (DPIA) er LOVP√ÖLAGT for 
h√∏yrisiko KI.

DPIA skal inneholde:
  ‚òê Systematisk beskrivelse av databehandlingen
  ‚òê Form√•l og n√∏dvendighet (hvorfor KI?)
  ‚òê Risikovurdering (hva kan g√• galt?)
  ‚òê Tiltak for √• redusere risiko
  ‚òê Proporsjonalitetsvurdering (nytte vs. risiko)
  ‚òê Godkjenning av personvernombud/DPO
  ‚òê √Örlig oppdatering

Verkt√∏y: 
https://www.datatilsynet.no/rettigheter-og-plikter/
virksomhetenes-plikter/vurdere-personvernkonsekvenser/


2.3 INFORMER ELEVER OG FORESATTE
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Transparens er et krav b√•de i GDPR og AI Act.

Hva skal informeres om:
  ‚òê Hvilke KI-verkt√∏y som brukes
  ‚òê Form√•l (hvorfor brukes KI?)
  ‚òê Hvilke data som samles inn
  ‚òê Hvordan data beskyttes
  ‚òê Hvem som har tilgang til data
  ‚òê Hvor lenge data lagres
  ‚òê Rett til innsyn, sletting og reservasjon
  ‚òê Kontaktinformasjon for sp√∏rsm√•l

Kanal: Foreldrem√∏te, nyhetsbrev, Vigilo/Its learning


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FASE 3: ANSVAR OG ORGANISERING (UKE 5-6)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

3.1 OPPRETT KI-ARBEIDSGRUPPE
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Samle n√∏kkelpersoner som skal jobbe med KI-implementering.

Hvem skal v√¶re med:
  ‚òê Skoleleder (ansvarlig for compliance)
  ‚òê IKT-ansvarlig (teknisk kompetanse)
  ‚òê Personvernombud/DPO (GDPR-ansvar)
  ‚òê L√¶rerrepresentant (brukerperspektiv)
  ‚òê Elevrepresentant (brukermedvirkning)
  ‚òê Tillitsvalgt (medbestemmelse)

M√∏tefrekvens: M√•nedlig f√∏rste √•r, deretter kvartalsvis


3.2 UTARBEID RETNINGSLINJER
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Skriv ned klare retningslinjer for bruk av KI p√• skolen.

Retningslinjer skal dekke:
  ‚òê Tillatte KI-verkt√∏y og bruksomr√•der
  ‚òê Forbudte verkt√∏y og praksiser
  ‚òê L√¶rernes ansvar og plikter
  ‚òê Elevenes rettigheter (klageadgang, innsyn)
  ‚òê Pedagogisk begrunnelse for KI-bruk
  ‚òê Personvern og datasikkerhet
  ‚òê Vurdering og evaluering med KI
  ‚òê H√•ndtering av hendelser og klager
  ‚òê Prosess for evaluering og oppdatering

Godkjenning: Skolens ledelse + medvirkning fra 
ansatte og elever


3.3 DEFINER ANSVARSROLLER
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Klargj√∏r hvem som er ansvarlig for hva.

Rollebeskrivelser:
  ‚Ä¢ SKOLELEDER: Overordnet ansvar for AI Act compliance
  ‚Ä¢ IKT-ANSVARLIG: Teknisk drift, avtaler med leverand√∏rer
  ‚Ä¢ PERSONVERNOMBUD: GDPR-compliance, DPIA-godkjenning
  ‚Ä¢ KI-KOORDINATOR: Daglig oppf√∏lging av KI-verkt√∏y
  ‚Ä¢ L√ÜRERE: Ansvarlig bruk, dokumentasjon, tilbakemelding
  ‚Ä¢ LEVERAND√òR: Teknisk dokumentasjon, oppdateringer, support

Dokument: Lag en RACI-matrise 
(Responsible, Accountable, Consulted, Informed)


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FASE 4: KOMPETANSEBYGGING (P√ÖG√ÖENDE)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

4.1 OPPL√ÜRING FOR L√ÜRERE
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Alle l√¶rere m√• ha grunnleggende KI- og AI Act-kompetanse.

Oppl√¶ringstemaer:
  ‚òê Hva er KI? (Grunnleggende forst√•else)
  ‚òê AI Act og GDPR (Juridisk ramme)
  ‚òê Risikovurdering (Hvordan klassifisere?)
  ‚òê Personvern og datasikkerhet
  ‚òê Elevrettigheter og medvirkning
  ‚òê Ansvarlig bruk av KI i vurdering
  ‚òê Pedagogisk bruk (n√•r er KI hensiktsmessig?)
  ‚òê H√•ndtering av hendelser

Ressurs: 
https://www.udir.no/laring-og-trivsel/rammeverk/
kompetansepakke-for-kunstig-intelligens-i-skolen/


4.2 KI-UNDERVISNING FOR ELEVER
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Elever skal forst√• KI og sine rettigheter.

L√¶rem√•l for elever:
  ‚òê Hva er KI og hvordan fungerer det?
  ‚òê Kildekritikk (KI gj√∏r feil!)
  ‚òê Etikk og ansvar
  ‚òê Personvern og datarettigheter
  ‚òê Rett til innsyn, sletting og klage
  ‚òê Opphavsrett og KI-generert innhold
  ‚òê Kreativ og kritisk bruk

Integrasjon: Tverrfaglig i alle fag


4.3 L√òPENDE KOMPETANSEHEVING
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

KI-feltet utvikler seg raskt. Kontinuerlig l√¶ring er 
n√∏dvendig.

Arenaer for l√¶ring:
  ‚òê M√•nedlige frokostm√∏ter om KI
  ‚òê Fagfellesskap (f.eks. l√¶rerLiv.no)
  ‚òê Nyhetsbrev fra Datatilsynet og Udir
  ‚òê Kurs og webinarer
  ‚òê Pilotering og testing av nye verkt√∏y
  ‚òê Deling av erfaringer p√• personalm√∏ter

Tid: Sett av 2 timer/m√•ned i √•rshjulet


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FASE 5: OPPF√òLGING OG EVALUERING (KONTINUERLIG)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

5.1 LOGGING OG MONITORERING
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Dokumenter bruk av KI-systemer, spesielt h√∏yrisiko.

Hva skal logges:
  ‚òê Bruksstatistikk (hvor mye brukes systemet?)
  ‚òê L√¶rerinngrep (overstyringer av KI-beslutninger)
  ‚òê Hendelser og feil
  ‚òê Klager fra elever/foresatte
  ‚òê Systemoppdateringer og endringer
  ‚òê DPIA-oppdateringer

Lagringstid: Minimum 6 m√•neder (AI Act Art. 29)


5.2 BIAS-TESTING OG KVALITETSKONTROLL
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Test KI-systemer jevnlig for bias og diskriminering.

Testomr√•der:
  ‚òê Kj√∏nnsbias (gutter vs. jenter?)
  ‚òê Spr√•kbias (norsk vs. andre spr√•k?)
  ‚òê Alderbias (yngre vs. eldre elever?)
  ‚òê Kulturell bias (minoriteter?)
  ‚òê Funksjonshemming (universell utforming?)
  ‚òê Teknisk n√∏yaktighet (feilrater?)

Frekvens: Halv√•rlig for h√∏yrisiko-systemer


5.3 √ÖRLIG GJENNOMGANG
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Sett av tid i √•rshjulet til √• evaluere og oppdatere.

Sjekkliste √•rlig gjennomgang:
  ‚òê Oppdater oversikt over KI-verkt√∏y
  ‚òê Re-evaluer risikoniv√•
  ‚òê Sjekk at alle avtaler er gyldige
  ‚òê DPIA-oppdatering for h√∏yrisiko
  ‚òê Evaluer retningslinjer (trenger de endring?)
  ‚òê H√∏r med brukere (l√¶rere, elever, foresatte)
  ‚òê Analyser logger og hendelser
  ‚òê Dokumenter compliance med AI Act
  ‚òê Sett m√•l for neste √•r

Tidspunkt: Mai/juni (planlegg for nytt skole√•r)


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
KRISEH√ÖNDTERING
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Hvis noe g√•r galt:

1. STOPP bruken av systemet umiddelbart

2. DOKUMENTER hendelsen
   - Hva skjedde?
   - N√•r skjedde det?
   - Hvem ble ber√∏rt?

3. INFORMER ber√∏rte parter
   - Elever
   - Foresatte
   - Personvernombud

4. KONTAKT leverand√∏r og personvernombud

5. VURDER rapporteringsplikt
   - Brudd p√• GDPR m√• rapporteres til Datatilsynet 
     innen 72 timer
   - Alvorlige AI Act-hendelser m√• rapporteres

6. JUSTER rutiner for √• forhindre gjentakelse


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
RESSURSER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

EU AI Act:
https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689

Datatilsynet (GDPR):
https://www.datatilsynet.no/

Datatilsynet (KI-veiledning):
https://www.datatilsynet.no/regelverk-og-verktoy/
kunstig-intelligens-og-personvern/

Utdanningsdirektoratet (KI-kompetansepakke):
https://www.udir.no/laring-og-trivsel/rammeverk/
kompetansepakke-for-kunstig-intelligens-i-skolen/

Lovdata - Oppl√¶ringsloven:
https://lovdata.no/dokument/NL/lov/1998-07-17-61

Lovdata - Personopplysningsloven:
https://lovdata.no/dokument/NL/lov/2018-06-15-38

l√¶rerLiv (fagfellesskap):
https://www.laererliv.no/


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Denne tiltaksplanen er generert av: KI-forordningen i skolen
Versjon: 0.4 | Lisens: CC BY-SA
Repository: github.com/barx10/ki_forordninga

VIKTIG: Dette er en veiledende tiltaksplan. Konsulter alltid
med personvernombud, DPO og skolens ledelse f√∏r implementering
av KI-systemer.

For mer informasjon og interaktiv veiviser:
https://github.com/barx10/ki_forordninga

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
`;

  const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `ki-tiltaksplan-${timestamp}.txt`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// === RISK LEVEL MODAL ===
const riskData = {
  minimal: {
    icon: '‚úÖ',
    title: 'Minimal risiko',
    subtitle: 'Lav risiko for brukerrettigheter',
    description: 'KI-systemer med minimal eller ingen risiko for menneskers rettigheter og sikkerhet. Disse systemene har sv√¶rt f√• krav i AI Act.',
    characteristics: [
      'Begrenset interaksjon med brukere',
      'Ingen p√•virkning p√• rettigheter eller sikkerhet',
      'Enkle, veldefinerte oppgaver',
      'Lav sannsynlighet for feil med alvorlige konsekvenser'
    ],
    examples: {
      title: 'Eksempler fra skolen:',
      items: [
        'üìß <strong>Spamfilter:</strong> Filtrerer e-post automatisk, men p√•virker ikke rettigheter',
        'üéÆ <strong>Enkle l√¶ringsspill:</strong> Spill uten adaptiv l√¶ring eller profilering',
        'üìä <strong>Statistikkverkt√∏y:</strong> Samler inn anonymiserte data for analyse',
        'üîç <strong>S√∏kefunksjoner:</strong> Enkle s√∏k i l√¶ringsressurser'
      ]
    },
    requirements: [
      'Frivillig √• f√∏lge Code of Conduct',
      'Ingen spesifikke compliance-krav',
      'God praksis anbefales, men ikke p√•krevd',
      'GDPR gjelder fortsatt hvis persondata behandles'
    ],
    action: 'Dokumenter hvilke systemer som er minimal risiko og f√∏lg god praksis.'
  },
  transparency: {
    icon: 'üí¨',
    title: 'Transparenskrav',
    subtitle: 'Generativ AI og chatboter',
    description: 'KI-systemer som interagerer med mennesker eller genererer innhold m√• v√¶re transparente. Brukere skal vite at de kommuniserer med KI.',
    characteristics: [
      'Genererer tekst, bilder, lyd eller video',
      'Brukes i direkte interaksjon med mennesker',
      'Kan p√•virke beslutninger',
      'Krever tydelig merking og informasjon'
    ],
    examples: {
      title: 'Eksempler fra skolen:',
      items: [
        'ü§ñ <strong>ChatGPT/Claude:</strong> M√• informere elever om at de bruker KI',
        'üé® <strong>DALL-E/Midjourney:</strong> M√• merke KI-genererte bilder',
        'üìù <strong>AI-skriveverkt√∏y:</strong> Elever m√• vite at forslag kommer fra KI',
        'üó£Ô∏è <strong>Stemmebots:</strong> M√• tydelig kommunisere at det er KI'
      ]
    },
    requirements: [
      'üì¢ <strong>Informasjonsplikt:</strong> Brukere m√• informeres om KI-bruk',
      'üè∑Ô∏è <strong>Merking:</strong> KI-generert innhold m√• merkes tydelig',
      'üìã <strong>Dokumentasjon:</strong> Logg hvordan KI brukes',
      'üîÑ <strong>Transparens:</strong> Forklar hvordan KI fungerer (p√• et fornuftig niv√•)',
      '‚öñÔ∏è <strong>GDPR-krav:</strong> Databehandleravtale hvis persondata brukes'
    ],
    warning: '<strong>NB!</strong> Transparenskravene er aktive fra august 2025. Hvis dere bruker ChatGPT, m√• elevene informeres.',
    action: 'Lag rutiner for informasjon til elever og foresatte. Merk KI-generert innhold.'
  },
  high: {
    icon: '‚ö†Ô∏è',
    title: 'H√∏y risiko',
    subtitle: 'Vurdering, karakterer og elevprofiler',
    description: 'KI-systemer som kan p√•virke elevers rettigheter, utdanning eller fremtid. Disse har strenge krav i AI Act.',
    characteristics: [
      'P√•virker vurdering, karakterer eller tilgang til utdanning',
      'Brukes til √• profilere eller klassifisere elever',
      'Kan ha diskriminerende effekter',
      'Krever omfattende dokumentasjon og kontroll'
    ],
    examples: {
      title: 'Eksempler fra skolen:',
      items: [
        'üìä <strong>KI-basert vurdering:</strong> Systemer som gir karakterer eller tilbakemeldinger',
        'üéØ <strong>Adaptive l√¶ringssystemer:</strong> Systemer som tilpasser innhold basert p√• elevdata',
        'üìà <strong>Elevprofiler:</strong> Systemer som lager profiler for √• predikere prestasjoner',
        'üö® <strong>Frav√¶r- og atferdssystemer:</strong> Systemer som automatisk rapporterer eller reagerer',
        'üîí <strong>Tilgangskontroll:</strong> KI som bestemmer hvem som f√•r tilgang til ressurser'
      ]
    },
    requirements: [
      'üìã <strong>Risikovurdering (DPIA):</strong> Grundig vurdering av risiko f√∏r bruk',
      'üìö <strong>Teknisk dokumentasjon:</strong> Komplett oversikt over systemet',
      'üîç <strong>Datastyring:</strong> Kontroll over treningsdata og kvalitet',
      'üë• <strong>Menneskelig oversikt:</strong> L√¶rer m√• kunne overstyre KI-beslutninger',
      'üîí <strong>Cybersikkerhet:</strong> Sikkerhetstiltak mot hacking',
      'üìù <strong>Logging:</strong> Minst 6 m√•neders logger',
      '‚öñÔ∏è <strong>Leverand√∏r-ansvar:</strong> Leverand√∏ren m√• v√¶re CE-merket',
      'üè´ <strong>Skole-ansvar:</strong> Dere er ansvarlige som brukere (Artikkel 29)'
    ],
    warning: '<strong>VIKTIG!</strong> H√∏yrisiko-krav gjelder fullt ut fra august 2027, men forberedelser m√• starte N√Ö. DPIA er p√•krevd.',
    action: 'Gjennomg√• alle h√∏yrisiko-systemer. Lag DPIA. Krev dokumentasjon fra leverand√∏r.'
  },
  unacceptable: {
    icon: 'üö´',
    title: 'Uakseptabel risiko',
    subtitle: 'Forbudte KI-praksiser',
    description: 'KI-systemer som utgj√∏r en uakseptabel trussel mot menneskers rettigheter og sikkerhet. Disse er FORBUDT i AI Act fra februar 2025.',
    characteristics: [
      'Manipulerer atferd p√• skadelig m√•te',
      'Utnytter s√•rbare grupper',
      'Gj√∏r skjult eller diskriminerende profilering',
      'Brukes til sosial scoring'
    ],
    examples: {
      title: 'Forbudt i skolen:',
      items: [
        'üß† <strong>Atferdsmanipulasjon:</strong> Systemer som manipulerer elever til √• handle mot sin vilje',
        'üë§ <strong>Skjult profilering:</strong> Systemer som profilerer elever uten deres kunnskap',
        'üèÜ <strong>Sosial scoring:</strong> Systemer som gir elever "poengsummer" basert p√• atferd',
        'üé≠ <strong>F√∏lelsesanalyse:</strong> Systemer som analyserer elevers f√∏lelser uten samtykke',
        'üìä <strong>Prediktiv atferd:</strong> Systemer som predikerer kriminalitet eller problematferd',
        'üö® <strong>Biometrisk identifikasjon:</strong> Sanntids ansiktsgjenkjenning i skoleg√•rden'
      ]
    },
    requirements: [
      'üö´ <strong>FORBUDT:</strong> Kan ikke brukes under noen omstendigheter',
      '‚öñÔ∏è <strong>Juridiske konsekvenser:</strong> Brudd kan f√∏re til store b√∏ter',
      'üóëÔ∏è <strong>Umiddelbar handling:</strong> Hvis dere bruker slikt, STOPP N√Ö',
      'üì¢ <strong>Rapporteringsplikt:</strong> Alvorlige hendelser m√• rapporteres'
    ],
    warning: '<strong>ADVARSEL!</strong> Forbudet tr√•dte i kraft februar 2025. Brudd kan f√∏re til b√∏ter p√• opptil ‚Ç¨35 millioner eller 7% av global omsetning.',
    action: 'Sjekk om dere har systemer som kan falle under uakseptabel risiko. Stopp bruken UMIDDELBART hvis ja.'
  }
};

function openRiskModal(riskLevel) {
  const modal = document.getElementById('riskModal');
  const modalBody = document.getElementById('modalBody');
  const data = riskData[riskLevel];
  
  if (!data) return;
  
  // Build modal content
  let content = `
    <div class="modal-header">
      <span class="modal-icon">${data.icon}</span>
      <div class="modal-title">
        <h2>${data.title}</h2>
        <p class="modal-subtitle">${data.subtitle}</p>
      </div>
    </div>
    
    <div class="modal-section">
      <p><strong>${data.description}</strong></p>
    </div>
    
    <div class="modal-section">
      <h3>Kjennetegn</h3>
      <ul class="modal-list">
        ${data.characteristics.map(item => `<li>${item}</li>`).join('')}
      </ul>
    </div>
    
    <div class="modal-examples">
      <h4>${data.examples.title}</h4>
      <ul class="modal-list">
        ${data.examples.items.map(item => `<li>${item}</li>`).join('')}
      </ul>
    </div>
    
    <div class="modal-section">
      <h3>Krav i AI Act</h3>
      <ul class="modal-list">
        ${data.requirements.map(item => `<li>${item}</li>`).join('')}
      </ul>
    </div>
  `;
  
  if (data.warning) {
    content += `
      <div class="${riskLevel === 'unacceptable' ? 'modal-warning' : 'modal-success'}">
        ${data.warning}
      </div>
    `;
  }
  
  content += `
    <div class="modal-footer">
      <p><strong>üí° Neste steg:</strong> ${data.action}</p>
      <button class="cta" onclick="closeRiskModal(); window.location.hash='#sjekk';">G√• til veiviseren ‚Üí</button>
    </div>
  `;
  
  modalBody.innerHTML = content;
  modal.classList.add('active');
  document.body.style.overflow = 'hidden'; // Prevent scrolling
}

function closeRiskModal(event) {
  // Close if clicking backdrop or close button
  if (!event || event.target.id === 'riskModal' || event.target.classList.contains('modal-close')) {
    const modal = document.getElementById('riskModal');
    modal.classList.remove('active');
    document.body.style.overflow = ''; // Restore scrolling
  }
}

// === GDPR MODAL ===
// === GDPR MODAL ===
const gdprData = {
  pol1: {
    icon: 'üìã',
    title: 'Personopplysningsloven artikkel 6',
    subtitle: 'Lovlig behandlingsgrunnlag',
    description: 'All behandling av personopplysninger m√• ha et lovlig grunnlag. Personopplysningsloven ¬ß 1 gj√∏r hele GDPR til norsk lov, inkludert GDPR artikkel 6 om behandlingsgrunnlag.',
    sections: [
      {
        title: 'Hva sier loven?',
        items: [
          '<strong>¬ß 1:</strong> GDPR gjelder som norsk lov (GDPR artikkel 6 om behandlingsgrunnlag)',
          '<strong>¬ß 8:</strong> Supplerende bestemmelser om behandling i allmennhetens interesse',
          'GDPR artikkel 6 nr. 1 bokstav e: Offentlig myndighetsut√∏velse eller allmenn interesse'
        ]
      },
      {
        title: 'For KI i skolen',
        items: [
          '<strong>Samtykke</strong> fungerer IKKE som grunnlag i offentlig sektor (det finnes et maktforhold - samtykket er ikke frivillig)',
          '<strong>Offentlig myndighetsut√∏velse</strong> er vanligvis grunnlaget (artikkel 6 nr. 1 bokstav e)',
          'Behandling m√• v√¶re n√∏dvendig for allmennhetens interesse eller lovp√•lagt plikt',
          'Oppl√¶ringsloven gir hjemmel for behandling av elevdata i undervisning og vurdering'
        ]
      }
    ],
    practical: 'Dokumenter behandlingsgrunnlag i DPIA. Bruk <strong>ikke</strong> samtykke - bruk myndighetsut√∏velse eller allmenn interesse som grunnlag.',
    link: 'https://lovdata.no/dokument/NL/lov/2018-06-15-38/KAPITTEL_gdpr-2#gdpr%2Fa6'
  },
  pol16: {
    icon: 'üìã',
    title: 'Personopplysningsloven artikkel 13-14',
    subtitle: 'Informasjonsplikt til elever og foresatte',
    description: 'Elever og foresatte har rett til √• vite hvordan deres personopplysninger brukes. Hovedregelen om informasjonsplikt ligger i GDPR artikkel 13-14, som gjelder direkte i Norge via ¬ß 1.',
    sections: [
      {
        title: 'Hva sier loven?',
        items: [
          '<strong>¬ß 16:</strong> Begrensninger i retten til informasjon (unntak fra GDPR art. 13-14)',
          'GDPR artikkel 13-14: Informasjonsplikt ved innsamling av personopplysninger',
          'Hovedregelen: Du <strong>m√•</strong> informere om KI-bruk',
          'Unntak gjelder kun i s√¶rskilte situasjoner (straffesaker, nasjonal sikkerhet)'
        ]
      },
      {
        title: 'For KI i skolen',
        items: [
          'Informer <strong>f√∏r</strong> KI-systemet tas i bruk',
          'Forklar p√• et spr√•k som elever og foresatte forst√•r',
          'Spesifiser hvilke data som samles inn og hvorfor',
          'Oppgi hvor lenge data lagres og hvem som har tilgang',
          'Forklar hvordan de kan ut√∏ve sine rettigheter (innsyn, sletting, klage)'
        ]
      }
    ],
    practical: 'Lag en egen informasjonsside om KI-bruk p√• skolens nettsted. Send ut informasjon p√• foreldrem√∏ter. Hovedregelen er at du <strong>m√•</strong> informere.',
    link: 'https://lovdata.no/dokument/NL/lov/2018-06-15-38/KAPITTEL_gdpr-3-2#KAPITTEL_gdpr-3-2'
  },
  pol1art22: {
    icon: 'üìã',
    title: 'Personopplysningsloven artikkel 22',
    subtitle: 'Automatiserte avgj√∏relser (GDPR art. 22)',
    description: 'Ingen skal utsettes for avgj√∏relser basert utelukkende p√• automatisk behandling som har rettslige eller vesentlige konsekvenser. GDPR artikkel 22 gjelder direkte i Norge via personopplysningsloven ¬ß 1.',
    sections: [
      {
        title: 'Hva sier loven?',
        items: [
          '<strong>¬ß 1:</strong> GDPR gjelder som norsk lov (inkludert artikkel 22)',
          'GDPR artikkel 22: Forbud mot rent automatiserte avgj√∏relser med rettsvirkning',
          'Norge har ikke egen paragraf for dette - det f√∏lger direkte av GDPR artikkel 22'
        ]
      },
      {
        title: 'For KI i skolen',
        items: [
          'KI kan <strong>aldri</strong> sette karakterer alene - en l√¶rer m√• alltid gj√∏re den endelige vurderingen',
          'KI kan foresl√•, men mennesker m√• bestemme',
          'Gjelder ogs√• opptak til skole, klasseinndeling, spesialundervisning, og andre vedtak med rettsvirkning',
          'Elever har rett til √• be om menneskelig vurdering og til √• bestride avgj√∏relsen',
          'Unntak krever uttrykkelig lovhjemmel, avtale, eller gyldig samtykke - og alltid med menneskelig kontroll'
        ]
      }
    ],
    practical: 'Dokumenter alltid at en kvalifisert person har sett gjennom og godkjent KI-output f√∏r det f√•r konsekvenser for eleven. Skolen kan <strong>ikke</strong> la KI fatte vedtak alene.',
    link: 'https://lovdata.no/dokument/NL/lov/2018-06-15-38/gdpr/ARTIKKEL_22#gdpr/ARTIKKEL_22'
  },
  pol1art28: {
    icon: 'üî¥',
    title: 'Personopplysningsloven artikkel 28',
    subtitle: 'Databehandleravtale (GDPR art. 28) - OBLIGATORISK',
    description: 'N√•r en ekstern leverand√∏r behandler personopplysninger p√• vegne av skolen, M√Ö det foreligge en bindende databehandleravtale. GDPR artikkel 28 gjelder direkte i Norge via personopplysningsloven ¬ß 1.',
    sections: [
      {
        title: 'Hva sier loven?',
        items: [
          '<strong>¬ß 1:</strong> GDPR gjelder som norsk lov (inkludert artikkel 28)',
          'GDPR artikkel 28: Krav til databehandleravtale',
          'Datatilsynet krever at innholdet i avtalen f√∏lger artikkel 28'
        ]
      },
      {
        title: 'For KI i skolen',
        items: [
          '<strong>OBLIGATORISK</strong> for alle KI-tjenester som behandler elevdata (ChatGPT, Google Classroom, osv.)',
          'Avtalen m√• beskrive: form√•l, varighet, typer opplysninger, kategorier registrerte, sikkerhetstiltak',
          'Leverand√∏ren (databehandler) skal kun handle p√• instruks fra skolen (behandlingsansvarlig)',
          'Skolen er <strong>behandlingsansvarlig</strong> og har ansvar selv om feilen skjer hos leverand√∏ren'
        ]
      }
    ],
    practical: 'IKKE bruk KI-verkt√∏y uten signert databehandleravtale. Sjekk om avtalen dekker tredjelandsoverf√∏ring (data utenfor EU/E√òS). Kravet gjelder direkte i Norge.',
    link: 'https://lovdata.no/dokument/NL/lov/2018-06-15-38/gdpr/ARTIKKEL_28#gdpr/ARTIKKEL_28'
  },
  pol9: {
    icon: 'üìã',
    title: 'Personopplysningsloven artikkel 35',
    subtitle: 'DPIA - Personvernkonsekvensvurdering (GDPR art. 35)',
    description: 'F√∏r bruk av ny teknologi som kan medf√∏re h√∏y risiko for personvernet, m√• det gjennomf√∏res en DPIA. Personopplysningsloven ¬ß 9 knytter GDPR artikkel 35 inn i norsk rett.',
    sections: [
      {
        title: 'Hva sier loven?',
        items: [
          '<strong>¬ß 9:</strong> R√•df√∏ring med personvernombud ved behandling av s√¶rlige kategorier personopplysninger',
          'Hvis DPIA etter GDPR artikkel 35 er utf√∏rt, oppfyller du r√•df√∏ringsplikten i ¬ß 9',
          'GDPR artikkel 35: Krav om DPIA ved h√∏yrisiko-behandling'
        ]
      },
      {
        title: 'For KI i skolen',
        items: [
          '<strong>OBLIGATORISK</strong> for h√∏yrisiko-KI (vurdering, karaktersetting, overv√•king, profilering)',
          'S√¶rlig viktig ved behandling av s√¶rlige kategorier personopplysninger (sensitive elevdata)',
          'M√• v√¶re ferdig <strong>f√∏r</strong> systemet tas i bruk',
          'Skal identifisere risikoer og beskrive tiltak for √• redusere dem',
          'Personvernombud skal r√•df√∏res (¬ß 9) - hvis DPIA er utf√∏rt, oppfyller du denne plikten',
          'Skal oppdateres √•rlig eller ved endringer'
        ]
      }
    ],
    practical: 'Bruk Datatilsynets DPIA-mal. Involver personvernombud tidlig i prosessen. ¬ß 9 gj√∏r DPIA til et krav for h√∏yrisiko-behandling av elevdata.',
    link: 'https://lovdata.no/dokument/NL/lov/2018-06-15-38/gdpr/ARTIKKEL_35#gdpr/ARTIKKEL_35'
  }
};

function openGDPRModal(article) {
  const modal = document.getElementById('riskModal');
  const modalBody = document.getElementById('modalBody');
  const data = gdprData[article];
  
  if (!data) return;
  
  let content = `
    <div class="modal-header">
      <span class="modal-icon">${data.icon}</span>
      <div class="modal-title">
        <h2>${data.title}</h2>
        <p class="modal-subtitle">${data.subtitle}</p>
      </div>
    </div>
    
    <div class="modal-section">
      <p><strong>${data.description}</strong></p>
    </div>
  `;
  
  data.sections.forEach(section => {
    content += `
      <div class="modal-section">
        <h3>${section.title}</h3>
        <ul class="modal-list">
          ${section.items.map(item => `<li>${item}</li>`).join('')}
        </ul>
      </div>
    `;
  });
  
  content += `
    <div class="modal-success">
      <strong>üí° Praktisk:</strong> ${data.practical}
    </div>
    
    <div class="modal-footer">
      <a href="${data.link}" target="_blank" rel="noopener" class="cta">Les mer om ${data.title} ‚Üí</a>
    </div>
  `;
  
  modalBody.innerHTML = content;
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
}

// === NORSK LOV MODAL ===
const norskLovData = {
  opplaringsloven: {
    icon: '‚öñÔ∏è',
    title: 'Oppl√¶ringsloven',
    subtitle: 'Elevens rettigheter',
    sections: [
      {
        title: '¬ß 1-1 Likeverd',
        items: [
          'KI-systemer m√• gi <strong>alle elever lik tilgang</strong> til god oppl√¶ring',
          'M√• fungere for elever med funksjonshemming (universell utforming)',
          'M√• ikke diskriminere basert p√• spr√•k, kultur eller bakgrunn',
          '<strong>Test regelmessig for bias!</strong>'
        ]
      },
      {
        title: '¬ß 3-1 Rettssikkerhet',
        items: [
          'Elever har rett til √• klage p√• vurderinger',
          'KI-baserte vurderinger m√• kunne <strong>forklares</strong> og <strong>etterpr√∏ves</strong>',
          'Elever har rett til √• vite at KI er brukt i vurderingen',
          'Klagesystemet m√• fungere selv n√•r KI er involvert'
        ]
      },
      {
        title: '¬ß 3-3 og Kap 9a - Psykososialt milj√∏',
        items: [
          'KI skal <strong>ikke</strong> brukes til overv√•king av elever p√• m√•ter som skaper utrygghet',
          'Elever skal beskyttes mot krenkelser - ogs√• fra KI-systemer',
          'Hvis KI oppdager mobbing, m√• skolen f√∏lge opp (ikke bare stole p√• KI)'
        ]
      }
    ],
    practical: 'Vurder hvordan KI p√•virker elevens rettigheter <strong>f√∏r</strong> bruk. Involver elevr√•d i beslutninger om KI.',
    link: 'https://lovdata.no/dokument/LTI/lov/2023-06-09-30'
  },
  personopplysningsloven: {
    icon: '‚öñÔ∏è',
    title: 'Personopplysningsloven',
    subtitle: 'GDPR i Norge',
    description: 'GDPR er implementert i norsk lov gjennom personopplysningsloven.',
    sections: [
      {
        title: 'Hva det betyr for skolen',
        items: [
          'Datatilsynet er tilsynsmyndighet i Norge',
          'Samme regler som GDPR, men tilpasset norsk forvaltning',
          'Sanksjoner kan gis av Datatilsynet',
          'Skolen m√• ha personvernombud (DPO) hvis den behandler personopplysninger systematisk'
        ]
      }
    ],
    practical: 'Ta kontakt med personvernombud ved alle sp√∏rsm√•l om KI og personvern. De skal hjelpe deg!',
    link: 'https://lovdata.no/dokument/NL/lov/2018-06-15-38'
  },
  diskrimineringsloven: {
    icon: 'üî¥',
    title: 'Diskrimineringsloven',
    subtitle: 'Forbud mot diskriminering',
    sections: [
      {
        title: '¬ß 6 Diskriminering i utdanning er forbudt',
        items: [
          'KI m√• <strong>ikke</strong> diskriminere basert p√• kj√∏nn, etnisitet, religion, funksjonsnedsettelse, seksuell orientering, eller alder',
          'Indirekte diskriminering er ogs√• forbudt (n√•r KI tilsynelatende er n√∏ytral, men rammer enkelte grupper hardere)',
          'Skolen har <strong>aktivitets- og redegj√∏relsesplikt</strong> - du m√• aktivt jobbe for √• forebygge diskriminering'
        ]
      }
    ],
    practical: 'Test KI-systemer for bias mot ulike elevgrupper. Dokumenter testing og tiltak. Juster algoritmer hvis bias oppdages.',
    link: 'https://lovdata.no/dokument/NL/lov/2017-06-16-51'
  },
  forvaltningsloven: {
    icon: '‚öñÔ∏è',
    title: 'Forvaltningsloven',
    subtitle: 'Elevens rett til klage',
    sections: [
      {
        title: '¬ß 2 Klagerett p√• forvaltningsvedtak',
        items: [
          'Avgj√∏relser som p√•virker elevers rettigheter er <strong>forvaltningsvedtak</strong>',
          'Elever/foresatte har rett til √• klage p√• vedtak (f.eks. karakterer, spesialundervisning, tilpasset oppl√¶ring)',
          'KI-baserte vedtak m√• kunne <strong>forklares</strong> i klagesak',
          'Klagenemnda m√• kunne etterpr√∏ve beslutningen'
        ]
      }
    ],
    practical: 'Dokumenter hvordan KI er brukt i vurderinger. S√∏rg for at l√¶rere kan forklare og begrunne vedtak selv n√•r KI er involvert.',
    link: 'https://lovdata.no/dokument/NL/lov/1967-02-10'
  }
};

function openNorskLovModal(law) {
  const modal = document.getElementById('riskModal');
  const modalBody = document.getElementById('modalBody');
  const data = norskLovData[law];
  
  if (!data) return;
  
  let content = `
    <div class="modal-header">
      <span class="modal-icon">${data.icon}</span>
      <div class="modal-title">
        <h2>${data.title}</h2>
        <p class="modal-subtitle">${data.subtitle}</p>
      </div>
    </div>
  `;
  
  if (data.description) {
    content += `
      <div class="modal-section">
        <p><strong>${data.description}</strong></p>
      </div>
    `;
  }
  
  data.sections.forEach(section => {
    content += `
      <div class="modal-section">
        <h3>${section.title}</h3>
        <ul class="modal-list">
          ${section.items.map(item => `<li>${item}</li>`).join('')}
        </ul>
      </div>
    `;
  });
  
  content += `
    <div class="modal-success">
      <strong>üí° Praktisk:</strong> ${data.practical}
    </div>
    
    <div class="modal-footer">
      <a href="${data.link}" target="_blank" rel="noopener" class="cta">Les ${data.title} p√• Lovdata ‚Üí</a>
    </div>
  `;
  
  modalBody.innerHTML = content;
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
}

// === AI ACT ARTIKLER MODAL ===
const aiActArticles = {
  art5: {
    icon: 'üö´',
    title: 'Artikkel 5',
    subtitle: 'Forbudte praksiser',
    description: 'Definerer KI-systemer som er forbudt fordi de utgj√∏r en uakseptabel risiko.',
    sections: [
      {
        title: 'Hva er forbudt?',
        items: [
          'Manipulasjon av atferd som kan skade personer',
          'Utnyttelse av s√•rbare grupper (barn, funksjonshemmede)',
          'Sosial scoring av borgere',
          'Sanntids biometrisk identifikasjon i offentlige rom (med snevre unntak)'
        ]
      },
      {
        title: 'For skolen',
        items: [
          'IKKE bruk KI som manipulerer elevers atferd',
          'IKKE lag "elevscorer" basert p√• atferd eller sosiale faktorer',
          'IKKE skjult f√∏lelsesanalyse uten samtykke',
          'IKKE sanntids ansiktsgjenkjenning i skoleg√•rden'
        ]
      }
    ],
    practical: 'Hvis dere bruker systemer som dette, stopp umiddelbart. Forbudet gjelder fra februar 2025.',
    norwegianPdfPage: 51,
    euLink: 'https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689'
  },
  art6: {
    icon: '‚ö†Ô∏è',
    title: 'Artikkel 6 + Vedlegg III',
    subtitle: 'H√∏yrisiko-klassifisering',
    description: 'Definerer hvilke KI-systemer som er h√∏yrisiko basert p√• bruksomr√•de.',
    sections: [
      {
        title: 'H√∏yrisiko i utdanning (Vedlegg III)',
        items: [
          'Tilgang til utdanning (opptak, klasseplassering)',
          'Vurdering og evaluering (karakterer, eksamener)',
          'Overv√•king og profilering av elevers atferd',
          'Adaptive l√¶ringssystemer med betydelig p√•virkning'
        ]
      },
      {
        title: 'For skolen',
        items: [
          'Alle systemer som p√•virker vurdering eller tilgang er h√∏yrisiko',
          'Krever DPIA, databehandleravtale, logging, menneskelig oversikt',
          'Leverand√∏ren m√• v√¶re CE-merket (fra august 2027)',
          'Skolen har ansvar som "deployer" (bruker av systemet)'
        ]
      }
    ],
    practical: 'Kartlegg alle h√∏yrisiko-systemer. Start forberedelser n√• - kravene gjelder fullt ut fra august 2027.',
    norwegianPdfPage: '53 (Artikkel 6) og 127 (Vedlegg III)',
    euLink: 'https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689'
  },
  art9: {
    icon: 'üìä',
    title: 'Artikkel 9',
    subtitle: 'Risikovurdering',
    description: 'Krav til risikostyringssystem for h√∏yrisiko KI-systemer.',
    sections: [
      {
        title: 'Hva kreves?',
        items: [
          'Identifiser og analyser kjente og forutsigbare risikoer',
          'Estimer og evaluer risikoer som kan oppst√• ved bruk',
          'Vurder risikoer basert p√• tilgjengelige data og testing',
          'Implementer egnede risikostyringstiltak'
        ]
      },
      {
        title: 'For skolen',
        items: [
          'Gjennomf√∏r DPIA f√∏r bruk (obligatorisk)',
          'Identifiser hva som kan g√• galt (bias, feil, diskriminering)',
          'Test systemet f√∏r full utrulling',
          'Ha beredskapsplan hvis noe g√•r galt'
        ]
      }
    ],
    practical: 'Bruk Datatilsynets DPIA-mal. Dokumenter alle risikoer og tiltak. Oppdater √•rlig.',
    norwegianPdfPage: 56,
    euLink: 'https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689'
  },
  art10: {
    icon: 'üìö',
    title: 'Artikkel 10',
    subtitle: 'Data og datastyring',
    description: 'Krav til kvalitet p√• treningsdata, testdata og valideringsdata.',
    sections: [
      {
        title: 'Datakvalitet',
        items: [
          'Data m√• v√¶re relevant, representativ og fri for feil',
          'M√• dekke alle relevante scenarier og bruksomr√•der',
          'M√• vurderes for mulig bias',
          'Dokumentasjon av datakilder og datakvalitet'
        ]
      },
      {
        title: 'For skolen',
        items: [
          'Krev dokumentasjon fra leverand√∏r om treningsdata',
          'Sjekk om data er representativ for norske elever',
          'Vurder om systemet fungerer likt for alle elevgrupper',
          'Test systemet med reelle elevdata f√∏r full bruk'
        ]
      }
    ],
    practical: 'Still sp√∏rsm√•l til leverand√∏r: Hvilke data er systemet trent p√•? Er det testet for bias? Fungerer det for norsk spr√•k og kultur?',
    norwegianPdfPage: 57,
    euLink: 'https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689'
  },
  art13: {
    icon: 'üìã',
    title: 'Artikkel 13',
    subtitle: 'Transparens og informasjon',
    description: 'Krav til dokumentasjon og brukerveiledning.',
    sections: [
      {
        title: 'Hva m√• dokumenteres?',
        items: [
          'Identitet og kontaktinformasjon til leverand√∏r',
          'Systemets egenskaper, kapasitet og begrensninger',
          'Forventet ytelse og n√∏yaktighet',
          'Instruksjoner for bruk',
          'Hva som kan g√• galt og hvordan h√•ndtere det'
        ]
      },
      {
        title: 'For skolen',
        items: [
          'Krev fullstendig dokumentasjon fra leverand√∏r',
          'Les brukerveiledningen f√∏r bruk',
          'Forst√• systemets begrensninger',
          'Informer l√¶rere om hva systemet kan og ikke kan'
        ]
      }
    ],
    practical: 'Ikke bruk KI-systemer uten fullstendig dokumentasjon. Lagre dokumentasjonen trygt - dere kan trenge den ved klagesaker.',
    norwegianPdfPage: 59,
    euLink: 'https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689'
  },
  art14: {
    icon: 'üëÅÔ∏è',
    title: 'Artikkel 14',
    subtitle: 'Menneskelig oversikt',
    description: 'Krav til menneskelig kontroll over h√∏yrisiko KI-systemer.',
    sections: [
      {
        title: 'Hva kreves?',
        items: [
          'Kvalifiserte personer m√• kunne overv√•ke systemet',
          'M√• kunne forst√• systemets beslutninger',
          'M√• kunne gripe inn og overstyre KI',
          'M√• kunne stoppe systemet hvis n√∏dvendig'
        ]
      },
      {
        title: 'For skolen',
        items: [
          'L√¶rere m√• alltid kunne overstyre KI-vurderinger',
          'KI kan aldri sette karakter alene - l√¶rer m√• godkjenne',
          'L√¶rere m√• forst√• hvordan KI kom frem til resultatet',
          'Ha rutiner for √• stoppe systemet ved feil'
        ]
      }
    ],
    practical: 'Tren l√¶rere i hvordan de skal overv√•ke og overstyre KI-systemer. Dokumenter alle overstyringer.',
    norwegianPdfPage: 60,
    euLink: 'https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689'
  },
  art26: {
    icon: 'üë§',
    title: 'Artikkel 26',
    subtitle: 'Brukerplikter (deployers)',
    description: 'Skolens ansvar som bruker av h√∏yrisiko KI-systemer.',
    sections: [
      {
        title: 'Skolens plikter',
        items: [
          'Bruk systemet i henhold til instruksjonene',
          'Tildel kvalifiserte personer til √• overv√•ke systemet',
          'Logg alle relevante hendelser og feil',
          'Rapporter alvorlige hendelser til tilsynsmyndigheten',
          'Gjennomf√∏r DPIA n√•r det kreves',
          'Stopp bruken hvis systemet ikke fungerer som det skal'
        ]
      },
      {
        title: 'For skolen',
        items: [
          'Dere er ansvarlige selv om leverand√∏ren eier systemet',
          'Hvis noe g√•r galt, er det dere som m√• h√•ndtere det',
          'Hold oversikt over hvordan systemet brukes',
          'Dokumenter alle avvik og hendelser'
        ]
      }
    ],
    practical: 'Lag rutiner for logging og rapportering. Bestem hvem som er ansvarlig for oppf√∏lging av KI-systemene.',
    norwegianPdfPage: 67,
    euLink: 'https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689'
  },
  art50: {
    icon: 'üí¨',
    title: 'Artikkel 50',
    subtitle: 'Transparensplikter',
    description: 'Krav til √•penhet n√•r KI brukes i interaksjon med mennesker eller genererer innhold.',
    sections: [
      {
        title: 'Hva kreves?',
        items: [
          'Informer brukere om at de interagerer med KI (chatboter)',
          'Merk KI-generert innhold tydelig (tekst, bilder, lyd, video)',
          'Informer om bruk av emosjonsgjenkjenning eller biometrisk kategorisering',
          'Informer om deepfakes eller manipulert innhold'
        ]
      },
      {
        title: 'For skolen',
        items: [
          'Hvis dere bruker ChatGPT eller lignende: Informer elevene',
          'KI-genererte bilder/tekster m√• merkes',
          'Elever m√• vite n√•r de snakker med en bot',
          'Gjelder fra august 2025 - gj√∏r det N√Ö!'
        ]
      }
    ],
    practical: 'Lag en standard informasjonstekst om KI-bruk. L√¶r elevene √• kjenne igjen KI-generert innhold. Implementer merking av KI-output.',
    norwegianPdfPage: 82,
    euLink: 'https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R1689'
  }
};

function openAIActModal(articleId) {
  const modal = document.getElementById('riskModal');
  const modalBody = document.getElementById('modalBody');
  const data = aiActArticles[articleId];
  
  if (!data) return;
  
  let content = `
    <div class="modal-header">
      <span class="modal-icon">${data.icon}</span>
      <div class="modal-title">
        <h2>${data.title}</h2>
        <p class="modal-subtitle">${data.subtitle}</p>
      </div>
    </div>
    
    <div class="modal-section">
      <p><strong>${data.description}</strong></p>
    </div>
  `;
  
  data.sections.forEach(section => {
    content += `
      <div class="modal-section">
        <h3>${section.title}</h3>
        <ul class="modal-list">
          ${section.items.map(item => `<li>${item}</li>`).join('')}
        </ul>
      </div>
    `;
  });
  
  content += `
    <div class="modal-success">
      <strong>üí° Praktisk:</strong> ${data.practical}
    </div>
    
    <div class="modal-footer">
      <p style="margin-bottom: 1rem;"><strong>üìÑ Les artikkelen:</strong></p>
      <a href="https://www.regjeringen.no/contentassets/e823dc21809c43f2b4ba9ff1e389e245/ki-forordningen-eu-2024.1689-uoffisiell-norsk-131037.pdf#page=${data.norwegianPdfPage.toString().split(' ')[0]}" target="_blank" rel="noopener" class="cta" style="margin-bottom: 0.5rem;">
        üá≥üá¥ Norsk oversettelse (side ${data.norwegianPdfPage}) ‚Üí
      </a>
      <a href="${data.euLink}" target="_blank" rel="noopener" class="cta secondary">
        üá™üá∫ Engelsk original (EUR-Lex) ‚Üí
      </a>
    </div>
  `;
  
  modalBody.innerHTML = content;
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
}

// Close modal with Escape key
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    closeRiskModal();
  }
});

// Fjern gammel scroll-basert navigasjon
// (Router h√•ndterer n√• all navigasjon)

